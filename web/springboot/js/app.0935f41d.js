(function(){"use strict";var e={3797:function(e,t,s){var a=s(5130),o=s(6768);function r(e,t,s,a,r,n){const l=(0,o.g2)("NavBar"),c=(0,o.g2)("router-view");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(l),(0,o.bF)(c)],64)}var n=s(4232);const l={class:"navbar navbar-expand-lg navbar-dark bg-dark"},c={class:"container"},i={class:"collapse navbar-collapse",id:"navbarText"},d={class:"navbar-nav me-auto mb-2 mb-lg-0"},u={class:"nav-item"},p={class:"nav-item"},m={class:"nav-item"},h={key:0,class:"navbar-nav"},k={class:"nav-item dropdown"},b={class:"nav-link dropdown-toggle",href:"#",id:"navbarDropdown",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},_={class:"dropdown-menu","aria-labelledby":"navbarDropdown"},v=(0,o.Lk)("li",null,[(0,o.Lk)("hr",{class:"dropdown-divider"})],-1),f={key:1,class:"navbar-nav"},g={class:"nav-item"},L={class:"nav-item"};function y(e,t,s,a,r,y){const w=(0,o.g2)("router-link");return(0,o.uX)(),(0,o.CE)("nav",l,[(0,o.Lk)("div",c,[(0,o.bF)(w,{class:"navbar-brand",to:{name:"home"}},{default:(0,o.k6)((()=>[(0,o.eW)("King Of Bots")])),_:1}),(0,o.Lk)("div",i,[(0,o.Lk)("ul",d,[(0,o.Lk)("li",u,[(0,o.bF)(w,{class:(0,n.C4)("pk_index"==a.route_name?"nav-link active":"nav-link"),to:{name:"pk_index"}},{default:(0,o.k6)((()=>[(0,o.eW)("对战")])),_:1},8,["class"])]),(0,o.Lk)("li",p,[(0,o.bF)(w,{class:(0,n.C4)("record_index"==a.route_name?"nav-link active":"nav-link"),to:{name:"record_index"}},{default:(0,o.k6)((()=>[(0,o.eW)("对局列表")])),_:1},8,["class"])]),(0,o.Lk)("li",m,[(0,o.bF)(w,{class:(0,n.C4)("ranklist_index"==a.route_name?"nav-link active":"nav-link"),to:{name:"ranklist_index"}},{default:(0,o.k6)((()=>[(0,o.eW)("排行榜")])),_:1},8,["class"])])]),e.$store.state.user.is_login||!e.$store.state.user.show_content?((0,o.uX)(),(0,o.CE)("ul",h,[(0,o.Lk)("li",k,[(0,o.Lk)("a",b,(0,n.v_)(e.$store.state.user.username),1),(0,o.Lk)("ul",_,[(0,o.Lk)("li",null,[(0,o.bF)(w,{class:"dropdown-item",to:{name:"userprofile",params:{userId:parseInt(e.$store.state.user.id)}}},{default:(0,o.k6)((()=>[(0,o.eW)("个人中心")])),_:1},8,["to"])]),(0,o.Lk)("li",null,[(0,o.bF)(w,{class:"dropdown-item",to:{name:"user_bot_index"}},{default:(0,o.k6)((()=>[(0,o.eW)("我的Bot")])),_:1})]),v,(0,o.Lk)("li",null,[(0,o.Lk)("a",{class:"dropdown-item",href:"#",onClick:t[0]||(t[0]=(...e)=>a.logout&&a.logout(...e))},"退出")])])])])):((0,o.uX)(),(0,o.CE)("ul",f,[(0,o.Lk)("li",g,[(0,o.bF)(w,{class:"nav-link",to:{name:"user_account_login"},role:"button"},{default:(0,o.k6)((()=>[(0,o.eW)(" 登录 ")])),_:1})]),(0,o.Lk)("li",L,[(0,o.bF)(w,{class:"nav-link",to:{name:"user_account_register"},role:"button"},{default:(0,o.k6)((()=>[(0,o.eW)(" 注册 ")])),_:1})])]))])])])}var w=s(1387),x=s(782),C={setup(){const e=(0,x.Pj)(),t=(0,w.lq)(),s=e.state.user.show_content;let a=(0,o.EW)((()=>t.name));const r=()=>{e.dispatch("logout")};return{route_name:a,logout:r,show_navbar:s}}},A=s(1241);const I=(0,A.A)(C,[["render",y]]);var j=I,E=s(5707),X={components:{NavBar:j},setup(){}};const P=(0,A.A)(X,[["render",r]]);var F=P;function S(e,t,s,a,r,n){const l=(0,o.g2)("ContentField");return(0,o.uX)(),(0,o.Wv)(l,null,{default:(0,o.k6)((()=>[(0,o.eW)(" 404 ")])),_:1})}const B={class:"container content-filed"},K={class:"card"},R={class:"card-body"};function O(e,t){return(0,o.uX)(),(0,o.CE)("div",B,[(0,o.Lk)("div",K,[(0,o.Lk)("div",R,[(0,o.RG)(e.$slots,"default",{},void 0,!0)])])])}const W={},$=(0,A.A)(W,[["render",O],["__scopeId","data-v-45cf9671"]]);var U=$,M={components:{ContentField:U}};const z=(0,A.A)(M,[["render",S]]);var q=z;const V={key:3,class:"user-color"},Q={key:4,class:"user-color"};function J(e,t,s,a,r,n){const l=(0,o.g2)("PlayGround"),c=(0,o.g2)("MatchGround"),i=(0,o.g2)("ResultBoard");return(0,o.uX)(),(0,o.CE)(o.FK,null,[1===e.$store.state.pk.status?((0,o.uX)(),(0,o.Wv)(l,{key:0})):(0,o.Q3)("",!0),0===e.$store.state.pk.status?((0,o.uX)(),(0,o.Wv)(c,{key:1})):(0,o.Q3)("",!0),"none"!=e.$store.state.pk.loser?((0,o.uX)(),(0,o.Wv)(i,{key:2})):(0,o.Q3)("",!0),1===e.$store.state.pk.status&&parseInt(e.$store.state.user.id)===parseInt(e.$store.state.pk.a_id)?((0,o.uX)(),(0,o.CE)("div",V," 左下角 ")):(0,o.Q3)("",!0),1===e.$store.state.pk.status&&parseInt(e.$store.state.user.id)===parseInt(e.$store.state.pk.b_id)?((0,o.uX)(),(0,o.CE)("div",Q," 右上角 ")):(0,o.Q3)("",!0)],64)}const G={class:"playground"};function T(e,t,s,a,r,n){const l=(0,o.g2)("GameMap");return(0,o.uX)(),(0,o.CE)("div",G,[(0,o.bF)(l)])}const D={ref:"parent",class:"gamemap"},N={ref:"canvas",tabindex:"0"};function H(e,t,s,a,r,n){return(0,o.uX)(),(0,o.CE)("div",D,[(0,o.Lk)("canvas",N,null,512)],512)}s(4114);const Y=[];class Z{constructor(){Y.push(this),this.timedelta=0,this.has_called_start=!1}start(){}update(){}on_detroy(){}destroy(){this.on_detroy();for(let e in Y){const t=Y[e];if(t===this){Y.splice(e,1);break}}}}let ee;const te=e=>{for(let t of Y)t.has_called_start?(t.timedelta=e-ee,t.update()):(t.has_called_start=!0,t.start());ee=e,requestAnimationFrame(te)};requestAnimationFrame(te);class se extends Z{constructor(e,t,s){super(),this.r=e,this.c=t,this.gamemap=s,this.color="#B37226"}update(){this.render()}render(){const e=this.gamemap.L,t=this.gamemap.ctx;t.fillStyle=this.color,t.fillRect(this.c*e,this.r*e,e+1,e+1)}}class ae{constructor(e,t){this.r=e,this.c=t,this.x=t+.5,this.y=e+.5}}class oe extends Z{constructor(e,t){super(),this.check_whoai=!1,this.a_id,this.b_id,this.myid,this.id=e.id,this.color=e.color,this.gamemap=t,this.cells=[new ae(e.r,e.c)],this.next_cell=null,this.speed=5,this.direction=-1,this.status="idle",this.dr=[-1,0,1,0],this.dc=[0,1,0,-1],this.step=0,this.eps=.01,this.eye_direction=0,1===this.id&&(this.eye_direction=2),this.eye_dx=[[-1,1],[1,1],[1,-1],[-1,-1]],this.eye_dy=[[-1,-1],[-1,1],[1,1],[1,-1]]}start(){}set_direction(e){this.direction=e}set_whoai(e){this.check_whoai=e}set_id(e,t,s){this.a_id=e,this.b_id=t,this.myid=s}check_tail_increasing(){return this.step<=10||this.step%3===1}next_step(){const e=this.direction;this.next_cell=new ae(this.cells[0].r+this.dr[e],this.cells[0].c+this.dc[e]),this.eye_direction=e,this.direction=-1,this.status="move",this.step++;const t=this.cells.length;for(let s=t;s>0;s--)this.cells[s]=JSON.parse(JSON.stringify(this.cells[s-1]))}update_move(){const e=this.next_cell.x-this.cells[0].x,t=this.next_cell.y-this.cells[0].y,s=Math.sqrt(e*e+t*t);if(s<this.eps)this.cells[0]=this.next_cell,this.next_cell=null,this.status="idle",this.check_tail_increasing()||this.cells.pop();else{const a=this.speed*this.timedelta/1e3;if(this.cells[0].x+=a*e/s,this.cells[0].y+=a*t/s,!this.check_tail_increasing()){const e=this.cells.length,t=this.cells[e-1],o=this.cells[e-2],r=o.x-t.x,n=o.y-t.y;t.x+=a*r/s,t.y+=a*n/s}}}update(){"move"===this.status&&this.update_move(),this.render()}render(){console.log(this.a_id,this.b_id,this.myid);const e=this.gamemap.L,t=this.gamemap.ctx;t.fillStyle=this.color,"die"===this.status&&(this.color="white");for(const s of this.cells)t.beginPath(),t.arc(s.x*e,s.y*e,e/2*.8,0,2*Math.PI),t.fill();for(let s=1;s<this.cells.length;s++){const a=this.cells[s-1],o=this.cells[s];Math.abs(a.x-o.x)<this.eps&&Math.abs(a.y-o.y)<this.eps||(Math.abs(a.x-o.x)<this.eps?t.fillRect((a.x-.4)*e,Math.min(a.y,o.y)*e,.8*e,Math.abs(a.y-o.y)*e):t.fillRect(Math.min(a.x,o.x)*e,(a.y-.4)*e,Math.abs(a.x-o.x)*e,.8*e))}t.fillStyle="black";for(let s=0;s<2;s++){const a=(this.cells[0].x+.15*this.eye_dx[this.eye_direction][s])*e,o=(this.cells[0].y+.15*this.eye_dy[this.eye_direction][s])*e;t.beginPath(),t.arc(a,o,.05*e,0,2*Math.PI),t.fill()}if(this.check_whoai){const s=this.cells[0];t.fillStyle="black",t.font="bold 12px Arial",t.fillText("我",s.x*e,s.y*e)}else{const s=this.cells[0];t.fillStyle="black",t.font="bold 12px Arial",t.fillText("对手",s.x*e,s.y*e)}}}class re extends Z{constructor(e,t,s){super(),this.store=s,this.ctx=e,this.parent=t,this.L=0,this.rows=15,this.cols=16,this.walls=[],this.inner_walls_count=40,this.snakes=[new oe({id:0,color:"#4876EC",r:this.rows-2,c:1},this),new oe({id:1,color:"#F94848",r:1,c:this.cols-2},this)]}create_walls(){const e=this.store.state.pk.gamemap;for(let t=0;t<this.rows;t++)for(let s=0;s<this.cols;s++)1===e[t][s]&&this.walls.push(new se(t,s,this))}add_listening_events(){if(console.log(this.store.state.record.is_record),this.store.state.record.is_record){let e=0;const t=this.store.state.record.a_steps,s=this.store.state.record.b_steps,a=this.store.state.record.record_loser,[o,r]=this.snakes,n=setInterval((()=>{e>=t.length-1?("all"!==a&&"A"!==a||(o.status="die"),"all"!==a&&"B"!==a||(r.status="die"),clearInterval(n)):(o.set_direction(parseInt(t[e])),r.set_direction(parseInt(s[e]))),e++}),300)}else this.ctx.canvas.focus(),this.ctx.canvas.addEventListener("keydown",(e=>{let t=-1;"w"===e.key?t=0:"d"===e.key?t=1:"s"===e.key?t=2:"a"===e.key&&(t=3),t>=0&&this.store.state.pk.socket.send(JSON.stringify({event:"move",direction:t}))}))}start(){this.create_walls(),this.add_listening_events()}update_size(){this.L=parseInt(Math.min(this.parent.clientWidth/this.cols,this.parent.clientHeight/this.rows)),this.ctx.canvas.width=this.cols*this.L,this.ctx.canvas.height=this.rows*this.L}check_ready(){for(const e of this.snakes){if("idle"!==e.status)return!1;if(-1===e.direction)return!1}return!0}check_tail_increasing(){return this.step<=10||this.step%3===1}next_step(){for(const e of this.snakes)e.next_step()}check_valid(e){for(const t of this.walls)if(t.r===e.r&&t.c===e.c)return!1;for(const t of this.snakes){let s=t.cells.length;t.check_tail_increasing()||s--;for(let a=0;a<s;a++)if(t.cells[a].r===e.r&&t.cells[a].c===e.c)return!1}return!0}update(){this.update_size(),this.check_ready()&&this.next_step(),this.render()}render(){const e="#AAD751",t="#A2D149";for(let s=0;s<this.rows;s++)for(let a=0;a<this.cols;a++)this.ctx.fillStyle=(s+a)%2==0?e:t,this.ctx.fillRect(a*this.L,s*this.L,this.L,this.L)}}var ne=s(144),le={setup(){const e=(0,x.Pj)();let t=(0,ne.KR)(null),s=(0,ne.KR)(null);return(0,o.sV)((()=>{e.commit("updateGameObject",new re(s.value.getContext("2d"),t.value,e));const a=e.state.pk.gameObject,[o,r]=a.snakes;o.set_whoai(parseInt(e.state.user.id)===parseInt(e.state.pk.a_id)),r.set_whoai(parseInt(e.state.user.id)===parseInt(e.state.pk.b_id))})),{parent:t,canvas:s}}};const ce=(0,A.A)(le,[["render",H],["__scopeId","data-v-5bb44471"]]);var ie=ce,de={components:{GameMap:ie}};const ue=(0,A.A)(de,[["render",T],["__scopeId","data-v-385ad2c7"]]);var pe=ue;const me=e=>((0,o.Qi)("data-v-b4677c14"),e=e(),(0,o.jt)(),e),he={class:"matchground"},ke={class:"row"},be={class:"col-4"},_e={class:"user-photo"},ve=["src"],fe={class:"user-username"},ge={class:"col-4"},Le={class:"user-select-bot"},ye=me((()=>(0,o.Lk)("option",{value:"-1",selected:""},"亲自出马",-1))),we=["value"],xe={class:"col-4"},Ce={class:"user-photo"},Ae=["src"],Ie={class:"user-username"},je={class:"col-12",style:{"text-align":"center","padding-top":"15vh"}};function Ee(e,t,s,r,l,c){return(0,o.uX)(),(0,o.CE)("div",he,[(0,o.Lk)("div",ke,[(0,o.Lk)("div",be,[(0,o.Lk)("div",_e,[(0,o.Lk)("img",{src:e.$store.state.user.photo,alt:""},null,8,ve)]),(0,o.Lk)("div",fe,(0,n.v_)(e.$store.state.user.username),1)]),(0,o.Lk)("div",ge,[(0,o.Lk)("div",Le,[(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.select_bot=e),class:"form-select","aria-label":"Default select example"},[ye,((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.bots,(e=>((0,o.uX)(),(0,o.CE)("option",{key:e.id,value:e.id},(0,n.v_)(e.title),9,we)))),128))],512),[[a.u1,r.select_bot]])])]),(0,o.Lk)("div",xe,[(0,o.Lk)("div",Ce,[(0,o.Lk)("img",{src:e.$store.state.pk.opponent_photo,alt:""},null,8,Ae)]),(0,o.Lk)("div",Ie,(0,n.v_)(e.$store.state.pk.opponent_username),1)]),(0,o.Lk)("div",je,[(0,o.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>r.click_match_btn&&r.click_match_btn(...e)),type:"button",class:"btn btn-warning btn-lg"},(0,n.v_)(r.match_btn_info),1)])])])}var Xe=s(6587),Pe=s.n(Xe),Fe={setup(){const e=(0,x.Pj)();let t=(0,ne.KR)("开始匹配"),s=(0,ne.KR)([]),a=(0,ne.KR)(-1);const o=()=>{"开始匹配"===t.value?(t.value="取消匹配",console.log(a.value),e.state.pk.socket.send(JSON.stringify({event:"start-matching",bot_id:a.value}))):(t.value="开始匹配",e.state.pk.socket.send(JSON.stringify({event:"stop-matching"})))},r=()=>{Pe().ajax({url:"https://app6142.acapp.acwing.com.cn/api/user/bot/getlist/",type:"get",headers:{Authorization:"Bearer "+e.state.user.token},success(e){s.value=e}})};return r(),{match_btn_info:t,click_match_btn:o,bots:s,select_bot:a}}};const Se=(0,A.A)(Fe,[["render",Ee],["__scopeId","data-v-b4677c14"]]);var Be=Se;const Ke={class:"result-board"},Re={key:0,class:"result-board-text"},Oe={key:1,class:"result-board-text"},We={key:2,class:"result-board-text"},$e={key:3,class:"result-board-text"},Ue={class:"result-board-btn"};function Me(e,t,s,a,r,n){return(0,o.uX)(),(0,o.CE)("div",Ke,["all"==e.$store.state.pk.loser?((0,o.uX)(),(0,o.CE)("div",Re," Draw ")):"A"===e.$store.state.pk.loser&&e.$store.state.pk.a_id==e.$store.state.user.id?((0,o.uX)(),(0,o.CE)("div",Oe," Lose ")):"B"===e.$store.state.pk.loser&&e.$store.state.pk.b_id==e.$store.state.user.id?((0,o.uX)(),(0,o.CE)("div",We," Lose ")):((0,o.uX)(),(0,o.CE)("div",$e,"Win!")),(0,o.Lk)("div",Ue,[(0,o.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>a.restart&&a.restart(...e)),type:"button",class:"btn btn-warning btn-lg"}," 再来! ")])])}var ze={setup(){const e=(0,x.Pj)(),t=()=>{e.commit("updateStatus",0),e.commit("updateLoser","none"),e.commit("emptyOpponent")};return{restart:t}}};const qe=(0,A.A)(ze,[["render",Me],["__scopeId","data-v-ee605ec4"]]);var Ve=qe,Qe={components:{PlayGround:pe,MatchGround:Be,ResultBoard:Ve},setup(){const e=(0,x.Pj)(),t=`wss://app6142.acapp.acwing.com.cn/websocket/${e.state.user.token}`;e.commit("updateLoser","none"),e.commit("updateIsRecord",!1);let s=null;(0,o.sV)((()=>{e.commit("updateOpponent",{username:"我的对手",photo:"https://cdn.acwing.com/media/article/image/2022/08/09/1_1db2488f17-anonymous.png"}),console.log("socketUrl"+t),s=new WebSocket(t),s.onopen=()=>{console.log("WebSocket连接已打开"),e.commit("updateSocket",s)},s.onmessage=t=>{const s=JSON.parse(t.data);if(console.log("data",s),"start-matching"===s.event)e.commit("updateOpponent",{username:s.opponent_username,photo:s.opponent_photo}),e.commit("updateGame",s.game),setTimeout((()=>{e.commit("updateStatus",1)}),200);else if("move"===s.event){const t=e.state.pk.gameObject,[a,o]=t.snakes;a.set_direction(s.a_direction),o.set_direction(s.b_direction)}else if("result"===s.event){const t=e.state.pk.gameObject,[a,o]=t.snakes;"all"!==s.loser&&"A"!==s.loser||(a.status="die"),"all"!==s.loser&&"B"!==s.loser||(o.status="die"),e.commit("updateLoser",s.loser)}console.log("收到消息:",s.event,s.a_direction)},s.onclose=()=>{console.log("WebSocket连接已关闭")}})),(0,o.hi)((()=>{s.close(),e.commit("updateStatus",0)}))}};const Je=(0,A.A)(Qe,[["render",J],["__scopeId","data-v-2a538a2a"]]);var Ge=Je;const Te=e=>((0,o.Qi)("data-v-9b578bd2"),e=e(),(0,o.jt)(),e),De={class:"table table-striped table-hover",style:{"text-align":"center"}},Ne=Te((()=>(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("th",null,"玩家"),(0,o.Lk)("th",null,"天梯分")])],-1))),He=["onClick"],Ye=["src"],Ze={class:"record-user-username"},et={"aria-label":"..."},tt={class:"pagination",style:{float:"right"}},st=Te((()=>(0,o.Lk)("a",{class:"page-link",href:"#"},"前一页",-1))),at=[st],ot=["onClick"],rt={class:"page-link",href:"#"},nt=Te((()=>(0,o.Lk)("a",{class:"page-link",href:"#"},"后一页",-1))),lt=[nt];function ct(e,t,s,a,r,l){const c=(0,o.g2)("ContentField");return(0,o.uX)(),(0,o.Wv)(c,null,{default:(0,o.k6)((()=>[(0,o.Lk)("table",De,[Ne,(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.users,(e=>((0,o.uX)(),(0,o.CE)("tr",{key:e.id,onClick:t=>a.getId(e.username)},[(0,o.Lk)("td",null,[(0,o.Lk)("img",{src:e.photo,alt:"",class:"record-user-photo"},null,8,Ye),(0,o.eW)("   "),(0,o.Lk)("span",Ze,(0,n.v_)(e.username),1)]),(0,o.Lk)("td",null,(0,n.v_)(e.rating),1)],8,He)))),128))])]),(0,o.Lk)("nav",et,[(0,o.Lk)("ul",tt,[(0,o.Lk)("li",{class:"page-item",onClick:t[0]||(t[0]=e=>a.click_page(-2))},at),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.pages,(e=>((0,o.uX)(),(0,o.CE)("li",{class:(0,n.C4)("page-item "+e.is_active),key:e.number,onClick:t=>a.click_page(e.number)},[(0,o.Lk)("a",rt,(0,n.v_)(e.number),1)],10,ot)))),128)),(0,o.Lk)("li",{class:"page-item",onClick:t[1]||(t[1]=e=>a.click_page(-1))},lt)])])])),_:1})}var it={components:{ContentField:U},setup(){const e=(0,x.Pj)();let t=(0,ne.KR)(0),s=(0,ne.KR)([]),a=1,o=0,r=(0,ne.KR)([]);const n=s=>{console.log(s),console.log(e.state.user.token),Pe().ajax({url:"http://localhost:3000/api/user/getid/",type:"post",data:{username:s},headers:{Authorization:"Bearer "+e.state.user.token},success(e){t.value=e.id,no.push({params:{userId:t.value},name:"userprofile"})},error(e){console.log(e)}})},l=e=>{-2===e?e=a-1:-1===e&&(e=a+1);let t=parseInt(Math.ceil(o/10));e>=1&&t>=e&&i(e)},c=()=>{let e=parseInt(Math.ceil(o/10)),t=[];for(let s=a-2;s<=a+2;s++)s>=1&&s<=e&&t.push({number:s,is_active:s===a?"active":""});r.value=t},i=t=>{a=t,Pe().ajax({url:"http://localhost:3000/api/ranklist/getlist/",data:{page:t},type:"get",headers:{Authorization:"Bearer "+e.state.user.token},success(e){s.value=e.users,o=e.users_count,c()}})};return i(a),{users:s,pages:r,click_page:l,getId:n,id:t}}};const dt=(0,A.A)(it,[["render",ct],["__scopeId","data-v-9b578bd2"]]);var ut=dt;function pt(e,t,s,a,r,n){const l=(0,o.g2)("PlayGround");return(0,o.uX)(),(0,o.Wv)(l)}var mt={components:{PlayGround:pe},setup(){}};const ht=(0,A.A)(mt,[["render",pt]]);var kt=ht;const bt=e=>((0,o.Qi)("data-v-3e5fff26"),e=e(),(0,o.jt)(),e),_t={class:"table table-striped table-hover",style:{"text-align":"center"}},vt=bt((()=>(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("th",null,"A"),(0,o.Lk)("th",null,"B"),(0,o.Lk)("th",null,"对战结果"),(0,o.Lk)("th",null,"对战时间"),(0,o.Lk)("th",null,"操作")])],-1))),ft=["src"],gt=["onClick"],Lt=["src"],yt=["onClick"],wt={class:"word"},xt=["onClick"],Ct={"aria-label":"..."},At={class:"pagination",style:{float:"right"}},It=bt((()=>(0,o.Lk)("a",{class:"page-link",href:"#"},"前一页",-1))),jt=[It],Et=["onClick"],Xt={class:"page-link",href:"#"},Pt=bt((()=>(0,o.Lk)("a",{class:"page-link",href:"#"},"后一页",-1))),Ft=[Pt];function St(e,t,s,a,r,l){const c=(0,o.g2)("ContentField");return(0,o.uX)(),(0,o.Wv)(c,null,{default:(0,o.k6)((()=>[(0,o.Lk)("table",_t,[vt,(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.records,(e=>((0,o.uX)(),(0,o.CE)("tr",{key:e.record.id},[(0,o.Lk)("td",null,[(0,o.Lk)("img",{src:e.a_photo,alt:"",class:"record-user-photo"},null,8,ft),(0,o.eW)("   "),(0,o.Lk)("span",{class:"record-user-username",onClick:t=>a.getId(e.a_username)},(0,n.v_)(e.a_username),9,gt)]),(0,o.Lk)("td",null,[(0,o.Lk)("img",{src:e.b_photo,alt:"",class:"record-user-photo"},null,8,Lt),(0,o.eW)("   "),(0,o.Lk)("span",{class:"record-user-username",onClick:t=>a.getId(e.b_username)},(0,n.v_)(e.b_username),9,yt)]),(0,o.Lk)("td",null,(0,n.v_)(e.result),1),(0,o.Lk)("td",wt,(0,n.v_)(e.record.createtime),1),(0,o.Lk)("td",null,[(0,o.Lk)("button",{onClick:t=>a.open_record_content(e.record.id),type:"button",class:"btn btn-secondary"}," 查看录像 ",8,xt)])])))),128))])]),(0,o.Lk)("nav",Ct,[(0,o.Lk)("ul",At,[(0,o.Lk)("li",{class:"page-item",onClick:t[0]||(t[0]=e=>a.click_page(-2))},jt),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(a.pages,(e=>((0,o.uX)(),(0,o.CE)("li",{class:(0,n.C4)("page-item "+e.is_active),key:e.number,onClick:t=>a.click_page(e.number)},[(0,o.Lk)("a",Xt,(0,n.v_)(e.number),1)],10,Et)))),128)),(0,o.Lk)("li",{class:"page-item",onClick:t[1]||(t[1]=e=>a.click_page(-1))},Ft)])])])),_:1})}var Bt={components:{ContentField:U},setup(){const e=(0,x.Pj)();let t=(0,ne.KR)([]),s=1,a=0,o=(0,ne.KR)([]),r=(0,ne.KR)(0);const n=t=>{console.log(t),console.log(e.state.user.token),Pe().ajax({url:"http://localhost:3000/api/user/getid/",type:"post",data:{username:t},headers:{Authorization:"Bearer "+e.state.user.token},success(e){r.value=e.id,console.log(r.value),no.push({params:{userId:r.value},name:"userprofile"})},error(e){console.log(e)}})},l=e=>{-2===e?e=s-1:-1===e&&(e=s+1);let t=parseInt(Math.ceil(a/10));e>=1&&t>=e&&i(e)},c=()=>{let e=parseInt(Math.ceil(a/10)),t=[];for(let a=s-2;a<=s+2;a++)a>=1&&a<=e&&t.push({number:a,is_active:a===s?"active":""});o.value=t},i=o=>{s=o,Pe().ajax({url:"https://app6142.acapp.acwing.com.cn/api/record/getlist/",data:{page:o},type:"get",headers:{Authorization:"Bearer "+e.state.user.token},success(s){t.value=s.records,a=s.records_count,a%10!==0&&(a=10*(parseInt(a/10)+1));for(let t=0;t<a;t++)e.state.record.id=t;c()}})};i(s);const d=e=>{let t=[];for(let s=0,a=0;s<15;s++){let s=[];for(let t=0;t<16;t++,a++)"0"==e.charAt(a)?s.push(0):s.push(1);t.push(s)}return t},u=s=>{for(const a of t.value)if(a.record.id===s){e.commit("updateIsRecord",!0),e.commit("updateGame",{map:d(a.record.map),a_id:a.record.aid,a_sx:a.record.asx,a_sy:a.record.asy,b_id:a.record.bid,b_sx:a.record.bsx,b_sy:a.record.bsy}),e.commit("updateSteps",{a_steps:a.record.asteps,b_steps:a.record.bsteps}),e.commit("updateRecordLoser",a.record.loser),no.push({name:"record_content",params:{recordId:s}});break}};return{records:t,open_record_content:u,pages:o,click_page:l,getId:n}}};const Kt=(0,A.A)(Bt,[["render",St],["__scopeId","data-v-3e5fff26"]]);var Rt=Kt;const Ot=e=>((0,o.Qi)("data-v-0109f5e0"),e=e(),(0,o.jt)(),e),Wt={class:"container"},$t={class:"row"},Ut={class:"col-3"},Mt={class:"card",style:{"margin-top":"20px"}},zt={class:"card-body"},qt=["src"],Vt={class:"col-9"},Qt={class:"card",style:{"margin-top":"20px"}},Jt={class:"card-header"},Gt=Ot((()=>(0,o.Lk)("span",{style:{"font-size":"140%"}},"我的Bot",-1))),Tt=Ot((()=>(0,o.Lk)("button",{type:"button",class:"btn btn-primary float-end","data-bs-toggle":"modal","data-bs-target":"#add-bot-btn"}," 创建Bot ",-1))),Dt={class:"modal fade",id:"add-bot-btn",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Nt={class:"modal-dialog modal-xl"},Ht={class:"modal-content"},Yt=Ot((()=>(0,o.Lk)("div",{class:"modal-header"},[(0,o.Lk)("h1",{class:"modal-title fs-5"},"创建Bot"),(0,o.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1))),Zt={class:"modal-body"},es={class:"mb-3"},ts=Ot((()=>(0,o.Lk)("label",{for:"add-bot-title",class:"form-label"},"名称",-1))),ss={class:"mb-3"},as=Ot((()=>(0,o.Lk)("label",{for:"add-bot-description",class:"form-label"},"简介 ",-1))),os={class:"mb-3"},rs=Ot((()=>(0,o.Lk)("label",{for:"add-bot-code",class:"form-label"},"代码 ",-1))),ns={class:"modal-footer"},ls={class:"error-message"},cs=Ot((()=>(0,o.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1))),is={class:"card-body"},ds={class:"table table-striped table-hover"},us=Ot((()=>(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[(0,o.Lk)("th",null,"名称"),(0,o.Lk)("th",null,"创建时间"),(0,o.Lk)("th",null,"操作")])],-1))),ps=["data-bs-target"],ms=["onClick"],hs=["id"],ks={class:"modal-dialog modal-xl"},bs={class:"modal-content"},_s=Ot((()=>(0,o.Lk)("div",{class:"modal-header"},[(0,o.Lk)("h1",{class:"modal-title fs-5",id:"exampleModalLabel"}," Bot信息 "),(0,o.Lk)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1))),vs={class:"modal-body"},fs={class:"mb-3"},gs=Ot((()=>(0,o.Lk)("label",{for:"add-bot-title",class:"form-label"},"名称",-1))),Ls=["onUpdate:modelValue"],ys={class:"mb-3"},ws=Ot((()=>(0,o.Lk)("label",{for:"add-bot-description",class:"form-label"},"简介 ",-1))),xs=["onUpdate:modelValue"],Cs={class:"mb-3"},As=Ot((()=>(0,o.Lk)("label",{for:"add-bot-code",class:"form-label"},"代码 ",-1))),Is={class:"modal-footer"},js={class:"error-message"},Es=["onClick"],Xs=Ot((()=>(0,o.Lk)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," 取消 ",-1)));function Ps(e,t,s,r,l,c){const i=(0,o.g2)("VAceEditor");return(0,o.uX)(),(0,o.CE)("div",Wt,[(0,o.Lk)("div",$t,[(0,o.Lk)("div",Ut,[(0,o.Lk)("div",Mt,[(0,o.Lk)("div",zt,[(0,o.Lk)("img",{src:e.$store.state.user.photo,alt:"",style:{width:"100%"}},null,8,qt)])])]),(0,o.Lk)("div",Vt,[(0,o.Lk)("div",Qt,[(0,o.Lk)("div",Jt,[Gt,Tt,(0,o.Lk)("div",Dt,[(0,o.Lk)("div",Nt,[(0,o.Lk)("div",Ht,[Yt,(0,o.Lk)("div",Zt,[(0,o.Lk)("div",es,[ts,(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.botadd.title=e),type:"text",class:"form-control",id:"add-bot-title",placeholder:"请输入Bot名称"},null,512),[[a.Jo,r.botadd.title]])]),(0,o.Lk)("div",ss,[as,(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":t[1]||(t[1]=e=>r.botadd.description=e),class:"form-control",id:"add-bot-description",rows:"3",placeholder:"请输入Bot简介"},null,512),[[a.Jo,r.botadd.description]])]),(0,o.Lk)("div",os,[rs,(0,o.bF)(i,{value:r.botadd.content,"onUpdate:value":t[2]||(t[2]=e=>r.botadd.content=e),onInit:e.editorInit,lang:"c_cpp",theme:"textmate",style:{height:"300px"},options:{enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0,fontSize:18,tabSize:4,showPrintMargin:!1,highlightActiveLine:!0}},null,8,["value","onInit"])])]),(0,o.Lk)("div",ns,[(0,o.Lk)("div",ls,(0,n.v_)(r.botadd.error_message),1),(0,o.Lk)("button",{type:"button",class:"btn btn-primary",onClick:t[3]||(t[3]=(...e)=>r.add_bot&&r.add_bot(...e))}," 创建 "),cs])])])])]),(0,o.Lk)("div",is,[(0,o.Lk)("table",ds,[us,(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(r.bots,(t=>((0,o.uX)(),(0,o.CE)("tr",{key:t.id},[(0,o.Lk)("td",null,(0,n.v_)(t.title),1),(0,o.Lk)("td",null,(0,n.v_)(t.createtime),1),(0,o.Lk)("td",null,[(0,o.Lk)("button",{type:"button",class:"btn btn-success",style:{"margin-right":"10px"},"data-bs-toggle":"modal","data-bs-target":"#update-bot-modal-"+t.id}," 查看 ",8,ps),(0,o.Lk)("button",{type:"button",class:"btn btn-danger",onClick:e=>r.remove_bot(t)}," 删除 ",8,ms),(0,o.Lk)("div",{class:"modal fade",id:"update-bot-modal-"+t.id,tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},[(0,o.Lk)("div",ks,[(0,o.Lk)("div",bs,[_s,(0,o.Lk)("div",vs,[(0,o.Lk)("div",fs,[gs,(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":e=>t.title=e,type:"text",class:"form-control",id:"add-bot-title",placeholder:"请输入Bot名称"},null,8,Ls),[[a.Jo,t.title]])]),(0,o.Lk)("div",ys,[ws,(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":e=>t.description=e,class:"form-control",id:"add-bot-description",rows:"3",placeholder:"请输入Bot简介"},null,8,xs),[[a.Jo,t.description]])]),(0,o.Lk)("div",Cs,[As,(0,o.bF)(i,{value:t.content,"onUpdate:value":e=>t.content=e,onInit:e.editorInit,lang:"c_cpp",theme:"textmate",style:{height:"300px"},options:{enableBasicAutocompletion:!0,enableSnippets:!0,enableLiveAutocompletion:!0,fontSize:18,tabSize:4,showPrintMargin:!1,highlightActiveLine:!0}},null,8,["value","onUpdate:value","onInit"])])]),(0,o.Lk)("div",Is,[(0,o.Lk)("div",js,(0,n.v_)(r.botadd.error_message),1),(0,o.Lk)("button",{type:"button",class:"btn btn-primary",onClick:e=>r.update_bot(t)}," 保存 ",8,Es),Xs])])])],8,hs)])])))),128))])])])])])])])}var Fs=s(4740),Ss=s(7569),Bs=s.n(Ss),Ks=(s(4677),s(2962),s(2342),s(776),{components:{VAceEditor:Fs.f},setup(){Bs().config.set("basePath","https://cdn.jsdelivr.net/npm/ace-builds@"+s(7569).version+"/src-noconflict/");const e=(0,x.Pj)();let t=(0,ne.KR)([]);const a=(0,ne.Kh)({title:"",description:"",content:"",error_message:""}),o=()=>{Pe().ajax({url:"https://app6142.acapp.acwing.com.cn/api/user/bot/getlist/",type:"get",headers:{Authorization:"Bearer "+e.state.user.token},success(e){t.value=e}})};o();const r=()=>{a.error_message="",Pe().ajax({url:"https://app6142.acapp.acwing.com.cn/api/user/bot/add/",type:"post",data:{title:a.title,description:a.description,content:a.content},headers:{Authorization:"Bearer "+e.state.user.token},success(e){"success"===e.error_message?(o(),a.title="",a.description="",a.content="",E.Modal.getInstance("#add-bot-btn").hide()):a.error_message=e.error_message}})},n=t=>{a.error_message="",Pe().ajax({url:"https://app6142.acapp.acwing.com.cn/api/user/bot/remove/",type:"post",data:{bot_id:t.id},headers:{Authorization:"Bearer "+e.state.user.token},success(e){"success"===e.error_message?o():a.error_message=e.error_message}})},l=t=>{Pe().ajax({url:"https://app6142.acapp.acwing.com.cn/api/user/bot/update/",type:"post",data:{bot_id:t.id,title:t.title,description:t.description,content:t.content},headers:{Authorization:"Bearer "+e.state.user.token},success(e){"success"===e.error_message?(o(),E.Modal.getInstance("#update-bot-modal-"+t.id).hide()):a.error_message=e.error_message}})};return{bots:t,botadd:a,add_bot:r,remove_bot:n,update_bot:l}}});const Rs=(0,A.A)(Ks,[["render",Ps],["__scopeId","data-v-0109f5e0"]]);var Os=Rs;const Ws=e=>((0,o.Qi)("data-v-71248f1d"),e=e(),(0,o.jt)(),e),$s={class:"row justify-content-md-center"},Us={class:"col-3"},Ms={class:"mb-3"},zs=Ws((()=>(0,o.Lk)("label",{for:"username",class:"form-label"},"用户名",-1))),qs={class:"mb-3"},Vs=Ws((()=>(0,o.Lk)("label",{for:"password",class:"form-label"},"密码",-1))),Qs={class:"error-message"},Js=Ws((()=>(0,o.Lk)("button",{type:"submit",class:"btn btn-primary"},"提交",-1)));function Gs(e,t,s,r,l,c){const i=(0,o.g2)("ContentField");return e.$store.state.user.show_content?((0,o.uX)(),(0,o.Wv)(i,{key:0},{default:(0,o.k6)((()=>[(0,o.Lk)("div",$s,[(0,o.Lk)("div",Us,[(0,o.Lk)("form",{onSubmit:t[2]||(t[2]=(0,a.D$)(((...e)=>r.login&&r.login(...e)),["prevent"]))},[(0,o.Lk)("div",Ms,[zs,(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.username=e),type:"text",class:"form-control",id:"username",placeholder:"请输入用户名"},null,512),[[a.Jo,r.username]])]),(0,o.Lk)("div",qs,[Vs,(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>r.password=e),type:"password",class:"form-control",id:"password",placeholder:"请输入密码"},null,512),[[a.Jo,r.password]])]),(0,o.Lk)("div",Qs,(0,n.v_)(r.error_message),1),Js],32)])])])),_:1})):(0,o.Q3)("",!0)}var Ts={components:{ContentField:U},setup(){const e=(0,x.Pj)();let t=(0,ne.KR)(""),s=(0,ne.KR)(""),a=(0,ne.KR)("");const o=localStorage.getItem("jwt_token");o?(e.commit("updateToken",o),e.dispatch("getinfo",{success(){no.push({name:"home"})},error(){e.commit("removeToken"),e.state.user.show_content=!0}})):e.state.user.show_content=!0;const r=()=>{a.value="",e.dispatch("login",{username:t.value,password:s.value,success(){e.dispatch("getinfo",{success(){no.push({name:"home"})},error(){e.state.user.show_content=!0}})},error(){a.value="密码或者用户名"}})};return{username:t,password:s,login:r,error_message:a}}};const Ds=(0,A.A)(Ts,[["render",Gs],["__scopeId","data-v-71248f1d"]]);var Ns=Ds;const Hs=e=>((0,o.Qi)("data-v-147b4fc4"),e=e(),(0,o.jt)(),e),Ys={class:"row justify-content-md-center"},Zs={class:"col-3"},ea={class:"mb-3"},ta=Hs((()=>(0,o.Lk)("label",{for:"username",class:"form-label"},"用户名",-1))),sa={class:"mb-3"},aa=Hs((()=>(0,o.Lk)("label",{for:"password",class:"form-label"},"密码",-1))),oa={class:"mb-3"},ra=Hs((()=>(0,o.Lk)("label",{for:"password",class:"form-label"},"确认密码",-1))),na={class:"error-message"},la=Hs((()=>(0,o.Lk)("button",{type:"submit",class:"btn btn-primary"},"提交",-1)));function ca(e,t,s,r,l,c){const i=(0,o.g2)("ContentField");return(0,o.uX)(),(0,o.Wv)(i,null,{default:(0,o.k6)((()=>[(0,o.Lk)("div",Ys,[(0,o.Lk)("div",Zs,[(0,o.Lk)("form",{onSubmit:t[3]||(t[3]=(0,a.D$)(((...e)=>r.register&&r.register(...e)),["prevent"]))},[(0,o.Lk)("div",ea,[ta,(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.username=e),type:"text",class:"form-control",id:"username",placeholder:"请输入用户名"},null,512),[[a.Jo,r.username]])]),(0,o.Lk)("div",sa,[aa,(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>r.password=e),type:"password",class:"form-control",id:"password",placeholder:"请输入密码"},null,512),[[a.Jo,r.password]])]),(0,o.Lk)("div",oa,[ra,(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>r.comfirmedPassword=e),type:"password",class:"form-control",id:"comfirmedPassword",placeholder:"请再次输入密码"},null,512),[[a.Jo,r.comfirmedPassword]])]),(0,o.Lk)("div",na,(0,n.v_)(r.error_message),1),la],32)])])])),_:1})}var ia={components:{ContentField:U},setup(){let e=(0,ne.KR)(""),t=(0,ne.KR)(""),s=(0,ne.KR)(""),a=(0,ne.KR)("");const o=()=>{a.value="",Pe().ajax({url:"https://app6142.acapp.acwing.com.cn/api/user/account/register/",type:"post",data:{username:e.value,password:t.value,comfirmedPassword:s.value},success(e){console.log(e),"success"===e.error_message?no.push({name:"user_account_login"}):a.value=e.error_message},error(e){a.value=e.error_message}})};return{username:e,password:t,comfirmedPassword:s,error_message:a,register:o}}};const da=(0,A.A)(ia,[["render",ca],["__scopeId","data-v-147b4fc4"]]);var ua=da,pa={state:{id:"",username:"",photo:"",token:"",is_login:!1,show_content:!1,followerCount:""},getters:{},mutations:{updatefollowerCount(e,t){e.followerCount=t},updateUser(e,t){e.id=t.id,e.username=t.username,e.photo=t.photo,e.is_login=t.is_login},updateToken(e,t){e.token=t},logout(e){e.id="",e.username="",e.photo="",e.token="",e.is_login=!1}},actions:{login(e,t){Pe().ajax({url:"https://app6142.acapp.acwing.com.cn/api/user/account/token/",type:"post",data:{username:t.username,password:t.password},success(s){"success"===s.error_message?(localStorage.setItem("jwt_token",s.token),e.commit("updateToken",s.token),t.success(s)):t.error(s)}})},getinfo(e,t){Pe().ajax({url:"https://app6142.acapp.acwing.com.cn/api/user/account/info/",type:"get",headers:{Authorization:"Bearer "+e.state.token},success(s){"success"===s.error_message?(e.commit("updateUser",{...s,is_login:!0}),t.success(s)):t.error(s)},error(e){t.error(e)}})},logout(e){localStorage.removeItem("jwt_token"),e.commit("logout")}},modules:{}},ma={state:{status:0,socket:null,opponent_username:"",opponent_photo:"",gamemap:null,a_id:0,a_sx:0,a_sy:0,b_id:0,b_sx:0,b_sy:0,gameObject:null,loser:"none"},getters:{},mutations:{updateSocket(e,t){e.socket=t},emptyOpponent(e){e.opponent_username="我的对手",e.opponent_photo="https://cdn.acwing.com/media/article/image/2022/08/09/1_1db2488f17-anonymous.png"},updateOpponent(e,t){e.opponent_username=t.username,e.opponent_photo=t.photo},updateStatus(e,t){e.status=t},updateGame(e,t){e.gamemap=t.map,e.a_id=t.a_id,e.a_sx=t.a_sx,e.a_sy=t.a_sy,e.b_id=t.b_id,e.b_sx=t.b_sx,e.b_sy=t.b_sy},updateGameObject(e,t){e.gameObject=t},updateLoser(e,t){e.loser=t}},actions:{},modules:{}},ha={state:{is_record:!1,a_steps:"",b_steps:"",record_loser:""},getters:{},mutations:{updateIsRecord(e,t){e.is_record=t},updateSteps(e,t){e.a_steps=t.a_steps,e.b_steps=t.b_steps},updateRecordLoser(e,t){e.record_loser=t}},actions:{},modules:{}},ka=(0,x.y$)({state:{},getters:{},mutations:{},actions:{},modules:{user:pa,pk:ma,record:ha}});const ba={class:"row"},_a={class:"col-3"},va={class:"col-9"};function fa(e,t,s,a,r,n){const l=(0,o.g2)("UserProfileInfo"),c=(0,o.g2)("UserProfileWrite"),i=(0,o.g2)("UserProfilePosts"),d=(0,o.g2)("ContentField");return(0,o.uX)(),(0,o.Wv)(d,null,{default:(0,o.k6)((()=>[(0,o.Lk)("div",ba,[(0,o.Lk)("div",_a,[(0,o.bF)(l),(0,o.bF)(c)]),(0,o.Lk)("div",va,[(0,o.bF)(i,{posts:a.posts},null,8,["posts"])])])])),_:1})}const ga={class:"card"},La={class:"card-body"},ya={class:"row"},wa={class:"col-3"},xa=["src"],Ca={class:"col-9"},Aa={class:"username"},Ia={class:"fans"},ja={class:"rating"},Ea={key:0};function Xa(e,t,s,a,r,l){return(0,o.uX)(),(0,o.CE)("div",ga,[(0,o.Lk)("div",La,[(0,o.Lk)("div",ya,[(0,o.Lk)("div",wa,[(0,o.Lk)("img",{class:"img-fluid",alt:"",src:a.photo},null,8,xa)]),(0,o.Lk)("div",Ca,[(0,o.Lk)("div",Aa,(0,n.v_)(a.username),1),(0,o.Lk)("div",Ia,(0,n.v_)("粉丝数:"+a.followerCount),1),(0,o.Lk)("div",ja,(0,n.v_)("天梯分:"+a.rating),1),"self"!==a.status?((0,o.uX)(),(0,o.CE)("div",Ea,["unfollow"===a.status?((0,o.uX)(),(0,o.CE)("button",{key:0,type:"button",onClick:t[0]||(t[0]=(...e)=>a.follow&&a.follow(...e)),class:"btn btn-secondary btn-sm"}," +关注 ")):(0,o.Q3)("",!0),"follow"===a.status?((0,o.uX)(),(0,o.CE)("button",{key:1,type:"button",onClick:t[1]||(t[1]=(...e)=>a.unfollow&&a.unfollow(...e)),class:"btn btn-secondary btn-sm"}," 取消关注 ")):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0)])])])])}var Pa={name:"UserProfileInfo",setup(){const e=(0,w.lq)(),t=e.params.userId,s=(0,x.Pj)();let a=(0,ne.KR)("self"),o=(0,ne.KR)(""),r=(0,ne.KR)(0),n=(0,ne.KR)(""),l=(0,ne.KR)("");Pe().ajax({url:"http://localhost:3000/api/user/getInfo/",data:{id:t},type:"post",headers:{Authorization:"Bearer "+s.state.user.token},success(e){o.value=e.username,n.value=e.photo,l.value=e.rating,r.value=e.follows}});const c=()=>{Pe().ajax({url:"http://localhost:3000/api/follows/change/",data:{follower:s.state.user.id,following:t,status:"follow"},type:"get",headers:{Authorization:"Bearer "+s.state.user.token},success(e){"success"===e.error_message&&(a.value="follow",Pe().ajax({url:"http://localhost:3000/api/follows/add/",data:{user_id:t,change:1},type:"get",headers:{Authorization:"Bearer "+s.state.user.token},success(){r.value+=1}}))}})},i=()=>{Pe().ajax({url:"http://localhost:3000/api/follows/change/",data:{follower:s.state.user.id,following:t,status:"unfollow"},type:"get",headers:{Authorization:"Bearer "+s.state.user.token},success(e){"success"===e.error_message&&(a.value="unfollow",Pe().ajax({url:"http://localhost:3000/api/follows/add/",data:{user_id:t,change:-1},type:"get",headers:{Authorization:"Bearer "+s.state.user.token},success(){r.value-=1}}))},error(){}})};return{follow:c,unfollow:i,status:a,followerCount:r,username:o,photo:n,rating:l}}};const Fa=(0,A.A)(Pa,[["render",Xa],["__scopeId","data-v-b861f808"]]);var Sa=Fa;const Ba={class:"card"},Ka={class:"card-body"},Ra={class:"card single-post"},Oa={class:"card-body"},Wa=["onClick"];function $a(e,t,s,a,r,l){return(0,o.uX)(),(0,o.CE)("div",Ba,[(0,o.Lk)("div",Ka,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(s.posts.posts,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e.id},[(0,o.Lk)("div",Ra,[(0,o.Lk)("div",Oa,[(0,o.eW)((0,n.v_)(e.content)+" ",1),a.is_me?((0,o.uX)(),(0,o.CE)("button",{key:0,onClick:t=>a.delete_a_post(e.id),type:"button",class:"btn btn-danger btn-sm"}," 删除 ",8,Wa)):(0,o.Q3)("",!0)])])])))),128))])])}var Ua={name:"UserProfilePosts",props:{posts:{type:Object,required:!0},user:{type:Object,required:!0}},setup(e,t){const s=(0,x.Pj)();let a=(0,o.EW)((()=>e.user.id===s.state.user.id));const r=e=>{Pe().ajax({url:"https://app165.acapp.acwing.com.cn/myspace/post/",type:"delete",data:{post_id:e},headers:{Authorization:"Bearer "+s.state.user.access},success(s){"success"===s.result&&t.emit("delete_a_post",e)}})};return{is_me:a,delete_a_post:r}}};const Ma=(0,A.A)(Ua,[["render",$a],["__scopeId","data-v-6775b56d"]]);var za=Ma;const qa=e=>((0,o.Qi)("data-v-70891214"),e=e(),(0,o.jt)(),e),Va={class:"card edit-field"},Qa={class:"card-body"},Ja=qa((()=>(0,o.Lk)("label",{for:"edit-post",class:"form-label"},"编辑帖子",-1)));function Ga(e,t,s,r,n,l){return(0,o.uX)(),(0,o.CE)("div",Va,[(0,o.Lk)("div",Qa,[Ja,(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.content=e),class:"form-control",id:"edit-post",rows:"3"},null,512),[[a.Jo,r.content]]),(0,o.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>r.post_a_post&&r.post_a_post(...e)),type:"button",class:"btn btn-info"}," 发帖 ")])])}var Ta={name:"UserProfileWrite",setup(e,t){let s=(0,ne.KR)("");const a=(0,x.Pj)(),o=()=>{Pe().ajax({url:"https://app165.acapp.racwing.com.cn/myspace/post/",type:"POST",data:{content:s.value},headers:{Authorization:"Bearer "+a.state.user.access},success(e){"success"===e.result&&(t.emit("post_a_post",s.value),s.value="")}})};return{content:s,post_a_post:o}}};const Da=(0,A.A)(Ta,[["render",Ga],["__scopeId","data-v-70891214"]]);var Na=Da,Ha={name:"UserProfileView",components:{ContentField:U,UserProfileInfo:Sa,UserProfilePosts:za,UserProfileWrite:Na},setup(){const e=(0,ne.Kh)({});return{posts:e}}};const Ya=(0,A.A)(Ha,[["render",fa]]);var Za=Ya;function eo(e,t,s,a,r,n){const l=(0,o.g2)("ContentField");return(0,o.uX)(),(0,o.Wv)(l)}var to={name:"UserProfileView",components:{ContentField:U},setup(){const e=(0,x.Pj)();Pe().ajax({url:"http://localhost:3000/api/user/posts/add/",data:{id:1,post:"hello"},type:"post",headers:{Authorization:"Bearer "+e.state.user.token},success(e){console.log(e)}})}};const so=(0,A.A)(to,[["render",eo]]);var ao=so;const oo=[{path:"/",name:"home",redirect:"/pk/",meta:{requestAuth:!0}},{path:"/pk/",name:"pk_index",component:Ge,meta:{requestAuth:!0}},{path:"/record/",name:"record_index",component:Rt,meta:{requestAuth:!0}},{path:"/record/:recordId/",name:"record_content",component:kt,meta:{requestAuth:!0}},{path:"/ranklist/",name:"ranklist_index",component:ut,meta:{requestAuth:!0}},{path:"/user/bot/",name:"user_bot_index",component:Os,meta:{requestAuth:!0}},{path:"/404/",name:"not_found_index",component:q,meta:{requestAuth:!1}},{path:"/user/account/login/",name:"user_account_login",component:Ns,meta:{requestAuth:!1}},{path:"/user/account/register/",name:"user_account_register",component:ua,meta:{requestAuth:!1}},{path:"/userprofile/:userId/",name:"userprofile",component:Za,meta:{requestAuth:!0}},{path:"/test/",name:"test",component:ao,meta:{requestAuth:!1}},{path:"/:catchAll(.*)*",redirect:"/404/"}],ro=(0,w.aE)({history:(0,w.LA)(),routes:oo});ro.beforeEach(((e,t,s)=>{e.meta.requestAuth&&!ka.state.user.is_login?s({name:"user_account_login"}):s()}));var no=ro;(0,a.Ef)(F).use(ka).use(no).mount("#app")}},t={};function s(a){var o=t[a];if(void 0!==o)return o.exports;var r=t[a]={id:a,loaded:!1,exports:{}};return e[a].call(r.exports,r,r.exports,s),r.loaded=!0,r.exports}s.m=e,function(){s.amdD=function(){throw new Error("define cannot be used indirect")}}(),function(){var e=[];s.O=function(t,a,o,r){if(!a){var n=1/0;for(d=0;d<e.length;d++){a=e[d][0],o=e[d][1],r=e[d][2];for(var l=!0,c=0;c<a.length;c++)(!1&r||n>=r)&&Object.keys(s.O).every((function(e){return s.O[e](a[c])}))?a.splice(c--,1):(l=!1,r<n&&(n=r));if(l){e.splice(d--,1);var i=o();void 0!==i&&(t=i)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[a,o,r]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){s.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={524:0};s.O.j=function(t){return 0===e[t]};var t=function(t,a){var o,r,n=a[0],l=a[1],c=a[2],i=0;if(n.some((function(t){return 0!==e[t]}))){for(o in l)s.o(l,o)&&(s.m[o]=l[o]);if(c)var d=c(s)}for(t&&t(a);i<n.length;i++)r=n[i],s.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return s.O(d)},a=self["webpackChunkweb"]=self["webpackChunkweb"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=s.O(void 0,[504],(function(){return s(3797)}));a=s.O(a)})();
//# sourceMappingURL=app.0935f41d.js.map